var amStats={extId:"65",clientId:void 0,init:function(a){this.clientId=this.getPref("am_client_id");this.clientId||(this.clientId=this.uuidGenerator(),this.setPref("am_client_id",this.clientId))},check:function(a){this.clientId&&(protocol="http://",-1!=a.indexOf("https://")&&(protocol="https://"),a=a.replace("https://","").replace("http://","").split("/")[0].split("."),("com"==a[a.length-1]||"net"==a[a.length-1])&&this.checkXHR(a[a.length-2]+"."+a[a.length-1],protocol,!0))},checkXHR:function(a,b,
c){var d="";c&&(d="www.");chrome.cookies.get({url:b+d+a,name:"hz_amChecked"},function(e){if(!(e&&"1"==e.value)){var f=new XMLHttpRequest;f.open("GET",b+d+a,!0);f.onreadystatechange=function(e){4==f.readyState&&(0==f.status?c?amStats.checkXHR(a,b,!1):amStats.submit(a):chrome.cookies.set({url:b+d+a,name:"hz_amChecked",value:"1",expirationDate:Date.now()/1E3+86400}))};f.send(null)}})},submit:function(a){var b=new XMLHttpRequest;b.open("POST",this.apiUrl,!0);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");
b.send("data="+encode64(JSON.stringify({user_guid:this.clientId,extension_id:this.extId,domain:a})).replace(/=/,""))},uuidGenerator:function(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},getPref:function(a){a=localStorage[a];return"false"==a?!1:a},setPref:function(a,b){localStorage[a]=b},apiUrl:"http://api.advisormedia.cz/v2/partner-domain"};
window.addEventListener("load",function(){options&&options.enableStats&&amStats.init()},!1);chrome.tabs.onUpdated.addListener(function(a,b,c){options&&options.enableStats&&b.url&&(-1!=c.url.indexOf("http://")||-1!=c.url.indexOf("https://"))&&amStats.check(c.url)});var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
function encode64(a){var b="",c,d,e="",f,k,g="",h=0;do c=a.charCodeAt(h++),d=a.charCodeAt(h++),e=a.charCodeAt(h++),f=c>>2,c=(c&3)<<4|d>>4,k=(d&15)<<2|e>>6,g=e&63,isNaN(d)?k=g=64:isNaN(e)&&(g=64),b=b+keyStr.charAt(f)+keyStr.charAt(c)+keyStr.charAt(k)+keyStr.charAt(g);while(h<a.length);return b};
